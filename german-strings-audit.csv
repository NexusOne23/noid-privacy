"File","Line","Content"
"Apply-Win11-25H2-SecurityBaseline.ps1","59","- CRITICAL FIX: Windows Update über getaktete Verbindungen jetzt EIN (Security First!)"
"Apply-Win11-25H2-SecurityBaseline.ps1","75","- CRITICAL FIX: Device-Level Toggle für Kamera/Mikrofon (EnabledByUser=0)"
"Apply-Win11-25H2-SecurityBaseline.ps1","78","- INFO: Settings App muss neu gestartet werden um Änderungen zu sehen"
"Apply-Win11-25H2-SecurityBaseline.ps1","81","- FIX: AppxProvisionedPackage transcript errors komplett unterdrückt"
"Apply-Win11-25H2-SecurityBaseline.ps1","84","- NEW: Automatische Report-Generierung nach erfolgreicher Ausführung"
"Apply-Win11-25H2-SecurityBaseline.ps1","159","# Fängt undefinierte Variablen, nicht-existente Properties, etc. ab"
"Apply-Win11-25H2-SecurityBaseline.ps1","357","$script:mutexAcquired = $script:mutex.WaitOne(0)  # 0 = kein Warten, sofort prüfen"
"Apply-Win11-25H2-SecurityBaseline.ps1","619","# Custom Mode: Nur ausgewählte Module + ihre Dependencies"
"Apply-Win11-25H2-SecurityBaseline.ps1","622","# Füge immer Core hinzu (Pflicht-Modul!)"
"Apply-Win11-25H2-SecurityBaseline.ps1","628","# Berechne Dependencies für ausgewählte Module"
"Apply-Win11-25H2-SecurityBaseline.ps1","632","# Füge auch die Dependencies hinzu"
"Apply-Win11-25H2-SecurityBaseline.ps1","643","# Jetzt sortiere nach Priorität"
"Apply-Win11-25H2-SecurityBaseline.ps1","834","# Aber: powershell.exe statt &, damit es im eigenen Prozess läuft und wir KOMPLETT beenden können"
"Apply-Win11-25H2-SecurityBaseline.ps1","941","# Dot-Source das Backup-Script (läuft im selben Prozess)"
"Apply-Win11-25H2-SecurityBaseline.ps1","982","# $LASTEXITCODE = 1 bedeutet: User hat im Backup-Script [N] gewählt"
"Apply-Win11-25H2-SecurityBaseline.ps1","1049","# Config-Objekt für CLI-Modus erstellen"
"Apply-Win11-25H2-SecurityBaseline.ps1","1058","# Mode und Modules aus Config übernehmen (für Konsistenz)"
"Apply-Win11-25H2-SecurityBaseline.ps1","1094","# BEST PRACTICE: Kein -Append = Sauberer Log-Start ohne führendes \n"
"Apply-Win11-25H2-SecurityBaseline.ps1","1095","# Timestamp im Filename garantiert bereits unique Files (kein Überschreiben)"
"Apply-Win11-25H2-SecurityBaseline.ps1","1105","# VERSION BANNER (für BEIDE Modi - Interactive und Non-Interactive)"
"Apply-Win11-25H2-SecurityBaseline.ps1","1663","# CRITICAL: Transcript und Mutex CLEANUP (IMMER ausführen!)"
"Backup-SecurityBaseline.ps1","76","# Best Practice 25H2: Strict Mode aktivieren (fängt undefined variables, non-existent properties)"
"Backup-SecurityBaseline.ps1","127","# WICHTIG: Beim Dot-Sourcing ist $Global:CurrentLanguage bereits gesetzt - nicht überschreiben!"
"Backup-SecurityBaseline.ps1","182","$requiredSpaceGB = 0.1  # 100 MB Minimum für Backup"
"Backup-SecurityBaseline.ps1","209","Sort-Object LastWriteTime)  # ASCENDING = Älteste zuerst!"
"Backup-SecurityBaseline.ps1","216","$firstBackup = $existingBackups[0]  # ÄLTESTES = ORIGINAL-ZUSTAND"
"Backup-SecurityBaseline.ps1","219","# Zu löschende = ALLES außer erstem und neuesten 9"
"Backup-SecurityBaseline.ps1","316","# TIMEOUT: 60 Sekunden max für AppX-Enumeration"
"Backup-SecurityBaseline.ps1","1028","# ÄNDERUNG v1.7.11: LastUsedTime* werden NICHT mehr gesichert (Forensic-Tracking!)"
"Backup-SecurityBaseline.ps1","1286","# ""doppelte Schlüssel 'value' und 'Value'"" error during JSON serialization"
"Backup-SecurityBaseline.ps1","1327","# Backup für Kamera, Mikrofon, Location (Device-Level SubKeys)"
"Backup-SecurityBaseline.ps1","1457","# Verwende .NET API für UTF-8 ohne BOM"
"Backup-SecurityBaseline.ps1","1589","# Best Practice: Letzte Pause vor dem großen Start"
"Backup-SecurityBaseline.ps1","1596","# Set exit code and return (für Dot-Sourcing)"
"Backup-SecurityBaseline.ps1","1639","# Set exit code and return (für Dot-Sourcing)"
"Backup-SecurityBaseline.ps1","1647","# Set exit code and return (für Dot-Sourcing)"
"Restore-SecurityBaseline.ps1","1071","# Prüfe ob Wert existiert"
"Restore-SecurityBaseline.ps1","1085","# Key existierte NICHT vorher - sollte gelöscht werden"
"Restore-SecurityBaseline.ps1","1089","# Script hat den Key erstellt - löschen!"
"SecurityBaseline-Bloatware.ps1","205","# Prüfe ob erfolgreich (kein Error in $Error)"
"SecurityBaseline-Core.ps1","372","# CRITICAL CHECK: Ist Windows Defender überhaupt verfügbar?"
"SecurityBaseline-Core.ps1","387","return  # Überspringe komplette Defender-Konfiguration"
"SecurityBaseline-Core.ps1","390","# CRITICAL FIX: Defender Service MUSS laufen für PUA/ASR Configuration!"
"SecurityBaseline-Core.ps1","397","Start-Sleep -Seconds 3  # Warte bis Service vollständig hochgefahren ist"
"SecurityBaseline-Core.ps1","404","return  # Überspringe Defender-Konfiguration"
"SecurityBaseline-Core.ps1","434","# Registry Policy (HKLM\Policies) würde GUI ausgrauen"
"SecurityBaseline-Core.ps1","435","# Set-MpPreference lässt User die Option in GUI ändern (flexibility!)"
"SecurityBaseline-Core.ps1","450","# LÖSUNG: Set-RegistryValueSmart nimmt automatisch Ownership wenn nötig"
"SecurityBaseline-Core.ps1","486","# LÖSUNG: Set-RegistryValueSmart nimmt automatisch Ownership wenn nötig"
"SecurityBaseline-Core.ps1","542","# CRITICAL CHECK: Ist Windows Defender überhaupt verfügbar?"
"SecurityBaseline-Core.ps1","1580","[!] WICHTIG - KEIN DNS FALLBACK AUS SICHERHEITSGRÜNDEN!"
"SecurityBaseline-Core.ps1","1585","GRÜNDE (Security & Privacy First):"
"SecurityBaseline-Core.ps1","1587","2. SECURITY: Unsichere DNS-Server (kein DoH) sind anfällig für DNS-Spoofing"
"SecurityBaseline-Core.ps1","1593","- User kann manuell DNS ändern (z.B. auf Quad9 oder Google)"
"SecurityBaseline-Core.ps1","1596","ALTERNATIVE für Corporate/VPN:"
"SecurityBaseline-Core.ps1","1598","- VPN-Adapter werden automatisch übersprungen (behalten ihre DNS)"
"SecurityBaseline-Core.ps1","1625","# - IPv6 temporär nach vorne für Validierung"
"SecurityBaseline-Core.ps1","1626","# - Funktioniert für IPv4 UND IPv6!"
"SecurityBaseline-Core.ps1","1631","# WICHTIG: Erst alte Einträge entfernen (idempotent!)"
"SecurityBaseline-Core.ps1","1684","# CRITICAL FIX v1.7.11: doh=auto statt doh=yes für strengere Durchsetzung"
"SecurityBaseline-Core.ps1","1685","# auto = nur DoH für bekannte/registrierte Server (kein Fallback!)"
"SecurityBaseline-Core.ps1","1686","# yes = DoH wo möglich, aber Fallback erlaubt"
"SecurityBaseline-Core.ps1","1702","# WICHTIG: VPN-Adapter MÜSSEN ausgeschlossen werden!"
"SecurityBaseline-Core.ps1","1703","# VPN verwendet eigene DNS-Server - Überschreiben würde VPN-Tunnel brechen!"
"SecurityBaseline-Core.ps1","1767","# Check 3: MediaType = ""Tunnel"" (Fallback für ältere PS-Versionen)"
"SecurityBaseline-Core.ps1","1773","# Check 4: ComponentID prüfen (tiefere Ebene)"
"SecurityBaseline-Core.ps1","1778","$skipReason = ""ComponentID enthält TAP"""
"SecurityBaseline-Core.ps1","1782","# ComponentID nicht verfügbar (nicht kritisch)"
"SecurityBaseline-Core.ps1","1793","# DoH würde interne VM-DNS-Auflösung brechen!"
"SecurityBaseline-Core.ps1","1820","# WICHTIG: IPv6 temporär nach VORNE für Validierung, dann zurück"
"SecurityBaseline-Core.ps1","1827","Write-Verbose ""IPv6 ist aktiv - setze IPv6 nach vorne für DoH-Validierung..."""
"SecurityBaseline-Core.ps1","1829","# IPv6 nach VORNE (temporär für Validierung)"
"SecurityBaseline-Core.ps1","1844","# CRITICAL FIX v1.7.11: Warte für IPv6 DoH-Validierung"
"SecurityBaseline-Core.ps1","2283","# CRITICAL FIX v1.7.6: Windows 11 25H2 benötigt ZUSÄTZLICH Scenarios Keys!"
"SecurityBaseline-Core.ps1","2284","# Credential Guard Scenario (PFLICHT für Windows 11 25H2!)"
"SecurityBaseline-Core.ps1","2312","WICHTIG: Prüft ob BitLocker bereits aktiviert ist (Windows 11 Auto-Encryption!)"
"SecurityBaseline-Core.ps1","2320","GRÜNDE (Windows 11 25H2 macht das automatisch):"
"SecurityBaseline-Core.ps1","2330","- Synchronisiert über alle Geräte mit gleichem MS-Konto"
"SecurityBaseline-Core.ps1","2332","3. KEIN ZUSÄTZLICHES BACKUP NÖTIG:"
"SecurityBaseline-Core.ps1","2333","- Microsoft-Konto ist der sichere Speicherort (verschlüsselt)"
"SecurityBaseline-Core.ps1","2335","- Backup in lokale Datei wäre WENIGER sicher (könnte verloren gehen)"
"SecurityBaseline-Core.ps1","2338","- User kann Recovery Key selbst verwalten über MS-Konto"
"SecurityBaseline-Core.ps1","2339","- User kann Key zusätzlich exportieren/ausdrucken wenn gewünscht"
"SecurityBaseline-Core.ps1","2343","- Diese Function setzt nur Policies für zukünftige Änderungen"
"SecurityBaseline-Core.ps1","2348","- User kann BitLocker manuell aktivieren über Systemsteuerung"
"SecurityBaseline-Core.ps1","2349","- Windows fragt dann nach Speicherort für Recovery Key"
"SecurityBaseline-Core.ps1","2518","# Microsoft hat die Policy-Namen geändert - alte ""EncryptionMethod"" ist deprecated!"
"SecurityBaseline-Core.ps1","2620","# Prüfe CPU-Generation und gebe KLARE Empfehlung"
"SecurityBaseline-Core.ps1","2628","# Prüfe ob alte CPU OHNE AES-NI Support"
"SecurityBaseline-Core.ps1","2889","# Verwende .NET API für UTF-8 ohne BOM"
"SecurityBaseline-DNS.ps1","170","# Wir zählen Zeilen und multiplizieren mit 9 für echte Domain-Anzahl"
"SecurityBaseline-Interactive.ps1","373","# Pflicht-Module: Immer [X] und nicht änderbar"
"SecurityBaseline-Interactive.ps1","376","$checkColor = ""Yellow""  # Gelb für Pflicht!"
"SecurityBaseline-Localization.ps1","9","# WICHTIG: Nicht überschreiben wenn bereits gesetzt (z.B. von Parent-Script)"
"SecurityBaseline-Performance.ps1","10","Community-erprobte Performance-Optimierungen für Windows 11"
"SecurityBaseline-Performance.ps1","56","# Beide bleiben in Liste für Abwärtskompatibilität mit älteren Builds"
"SecurityBaseline-Performance.ps1","80","Optional = $true  # Existiert nur in älteren Builds"
"SecurityBaseline-Performance.ps1","87","Optional = $true  # Existiert nur in älteren Builds"
"SecurityBaseline-Performance.ps1","108","# Existiert nur auf Geräten mit LTE/5G"
"SecurityBaseline-Performance.ps1","112","Reason = ""Mobile Broadband (nur auf LTE/5G-Geräten)"""
"SecurityBaseline-Performance.ps1","114","Optional = $true  # Nur auf Mobile-Geräten"
"SecurityBaseline-Performance.ps1","130","Reason = ""Retail Demo (nur Store-Ausstellungsgeräte)"""
"SecurityBaseline-Performance.ps1","132","Optional = $true  # Nur auf Demo-Geräten"
"SecurityBaseline-Performance.ps1","171","# CIM-Errors KOMPLETT unterdrücken (nicht mal im Transcript!)"
"SecurityBaseline-Performance.ps1","178","# Task existiert nicht - überspringe"
"SecurityBaseline-Performance.ps1","183","# Task existiert - deaktiviere falls nötig"
"SecurityBaseline-Performance.ps1","394","# Null-Safe Check für MediaType (VMs haben oft keine MediaType Property)"
"SecurityBaseline-RegistryOwnership.ps1","8","Ermöglicht das Setzen von TrustedInstaller-geschützten Registry-Keys"
"SecurityBaseline-RegistryOwnership.ps1","11","Professionelles Ownership-Management für geschützte Registry-Keys."
"SecurityBaseline-RegistryOwnership.ps1","15","2. Take Ownership: Ändere zu BUILTIN\Administrators"
"SecurityBaseline-RegistryOwnership.ps1","17","4. Modify: Setze den gewünschten Wert"
"SecurityBaseline-RegistryOwnership.ps1","26","- Vollständiges Backup vor Änderungen"
"SecurityBaseline-RegistryOwnership.ps1","27","- Automatic Restore nach Änderungen"
"SecurityBaseline-RegistryOwnership.ps1","32","- Andere TrustedInstaller-geschützte Keys"
"SecurityBaseline-RegistryOwnership.ps1","38","# ===== PRIVILEGE MANAGEMENT (KRITISCH FÜR TRUSTEDINSTALLER RESTORE!) ====="
"SecurityBaseline-RegistryOwnership.ps1","43","Aktiviert Windows-Privilege für aktuellen Prozess"
"SecurityBaseline-RegistryOwnership.ps1","45","KRITISCH: SeRestorePrivilege wird benötigt um Ownership zurück zu TrustedInstaller zu setzen!"
"SecurityBaseline-RegistryOwnership.ps1","63","# P/Invoke Definitions für Token Manipulation"
"SecurityBaseline-RegistryOwnership.ps1","148","Nimmt temporär Ownership, setzt Wert, restored Ownership."
"SecurityBaseline-RegistryOwnership.ps1","149","Best Practice 2025: Vollständiges Backup/Restore"
"SecurityBaseline-RegistryOwnership.ps1","159","Beschreibung für Logging"
"SecurityBaseline-RegistryOwnership.ps1","265","# Ohne dieses Privilege schlägt OpenSubKey mit ""Access Denied"" fehl!"
"SecurityBaseline-RegistryOwnership.ps1","275","# Öffne Key mit TakeOwnership-Rechten"
"SecurityBaseline-RegistryOwnership.ps1","318","# Öffne Key mit ChangePermissions-Rechten"
"SecurityBaseline-RegistryOwnership.ps1","327","# Erstelle Full Control Rule für Administrators"
"SecurityBaseline-RegistryOwnership.ps1","340","# Füge Rule hinzu"
"SecurityBaseline-RegistryOwnership.ps1","353","# Enable SeRestorePrivilege für TrustedInstaller-Restore"
"SecurityBaseline-RegistryOwnership.ps1","376","# Prüfe ob Wert existiert"
"SecurityBaseline-RegistryOwnership.ps1","396","# Enable SeRestorePrivilege für TrustedInstaller-Restore"
"SecurityBaseline-RegistryOwnership.ps1","420","# Ohne dieses Privilege schlägt SetAccessControl fehl bei TrustedInstaller-Owner!"
"SecurityBaseline-RegistryOwnership.ps1","430","# Öffne Key mit vollen Rechten"
"SecurityBaseline-RegistryOwnership.ps1","514","# Unterdrückt Error im Transcript aber Try-Catch funktioniert trotzdem!"
"SecurityBaseline-RegistryOwnership.ps1","524","# Prüfe ob Wert existiert (SAFE method - no error records!)"
"SecurityBaseline-RegistryOwnership.ps1","561","if ($errorMsg -match ""Access.*denied|Zugriff.*verweigert|unzulässig|angeforderte.*Registrierungszugr"
"SecurityBaseline-RegistryOwnership.ps1","586","# Export Functions (für Dot-Sourcing)"
"SecurityBaseline-RegistryOwnership.ps1","587","# Functions sind automatisch verfügbar im calling scope"
